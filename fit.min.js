"use strict";(function(){function fit(str,pre){function tokenizer(e){var t="{{",r="}}",n=e.split(t);return n.reduce(function(e,t){if(t.indexOf(r)>-1){var n=t.split(r);return e.push("{{OP_"+n[0].trimLeft()),e.push(n[1]),e}return e.push(t),e},[])}function parser(e){var t=[],r=[];if(e.forEach(function(e){if(0===e.indexOf("{{OP_")){var n=e.substr(5),s=n.trim().split(/ |\$/)[0];if(oplist.indexOf(s)>-1)switch(s){case"=":r.length>0?r[r.length-1]["else"]?r[r.length-1]["else"].push(exp["="](n)):r[r.length-1].param.push(exp["="](n)):t.push(exp["="](n));break;case"for":r.push({exp:n,param:[]});break;case"endfor":var p=r.pop();r.length>0?r[r.length-1].param.push(exp["for"](p.exp,p.param)):t.push(exp["for"](p.exp,p.param));break;case"if":r.push({exp:n,param:[]});break;case"else":r[r.length-1]["else"]=[];break;case"endif":var p=r.pop();r.length>0?r[r.length-1]["else"]?r[r.length-1]["else"].push(exp["if"](p.exp,p.param,p["else"])):r[r.length-1].param.push(exp["if"](p.exp,p.param,p["else"])):t.push(exp["if"](p.exp,p.param,p["else"]))}else r.length>0?r[r.length-1]["else"]?!!r[r.length-1]["else"].push("{{unknown("+s+")}}"):r[r.length-1].param.push("{{unknown("+s+")}}"):t.push("{{unknown("+s+")}}")}else r.length>0?r[r.length-1]["else"]?r[r.length-1]["else"].push(e):r[r.length-1].param.push(e):t.push(e)}),r.length>0)throw"`for` or `if` statement not terminated.";return t}function render(e,t){return e.reduce(function(e,r){return"function"==typeof r?2===r.length?e+r(t,t):e+r(t):e+r},"")}String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")});var oplist=["=","for","endfor","if","else","endif"],exp={"=":function(_exp){return function(data){var e=_exp.substr(1).trim();return e=e.replace(/\$/g,"data."),eval(e)}},"for":function(e,t){var r=e.substr(3).trim().split("as"),n=r[0].trim().substr(1),s=r[1].trim().substr(1);return function(e,r){var p=n.split(".").reduce(function(e,t){return e[t]},e),u=n.substr(0,n.lastIndexOf(".")).split(".").reduce(function(e,t){return e[t]},e),i="";return p.forEach(function(e,n){var p={};p[s]=e,p[s]._index=n,p[s]._global=r,p[s]._parent=u,i+=t.reduce(function(e,t){return"function"==typeof t?2==t.length?e+t(p,r):e+t(p):e+t},"")}),i}},"if":function(_exp,_param,_else){var e=_exp.substr(2).trim();return function(data){e=e.replace(/\$/g,"data.");var s=eval(e)?_param:_else;return s?s.reduce(function(e,t){return"function"==typeof t?e+t(data):e+t},""):""}}},parsed;return pre&&(parsed=parser(tokenizer(str))),function(e){return void 0===parsed&&(parsed=parser(tokenizer(str))),render(parsed,e)}}var root=this,old_fit;"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=fit),exports.fit=fit):(old_fit=root.fit,root.fit=fit,fit.noConflict=function(){return root.fit=old_fit,fit})}).call(this);