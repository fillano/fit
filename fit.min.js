"use strict";(function(){function fit(str,pre){function tokenizer(e){var t="{{",r="}}",n=e.split(t);return n.reduce(function(e,t){if(t.indexOf(r)>-1){var n=t.split(r);return e.push("{{OP_"+n[0].trimLeft()),e.push(n[1]),e}return e.push(t),e},[])}function parser(e){var t=[],r=[];if(e.forEach(function(e){if(0===e.indexOf("{{OP_")){var n=e.substr(5),p=n.trim().split(/ |\$/)[0];if(oplist.indexOf(p)>-1)switch(p){case"=":r.length>0?r[r.length-1]["else"]?r[r.length-1]["else"].push(exp["="](n)):r[r.length-1].param.push(exp["="](n)):t.push(exp["="](n));break;case"for":r.push({exp:n,param:[]});break;case"endfor":var s=r.pop();r.length>0?r[r.length-1]["else"]?r[r.length-1]["else"].push(exp["for"](s.exp,s.param)):r[r.length-1].param.push(exp["for"](s.exp,s.param)):t.push(exp["for"](s.exp,s.param));break;case"if":r.push({exp:n,param:[]});break;case"else":r[r.length-1]["else"]=[];break;case"endif":var s=r.pop();r.length>0?r[r.length-1]["else"]?r[r.length-1]["else"].push(exp["if"](s.exp,s.param,s["else"])):r[r.length-1].param.push(exp["if"](s.exp,s.param,s["else"])):t.push(exp["if"](s.exp,s.param,s["else"]))}else r.length>0?r[r.length-1]["else"]?!!r[r.length-1]["else"].push("{{unknown("+p+")}}"):r[r.length-1].param.push("{{unknown("+p+")}}"):t.push("{{unknown("+p+")}}")}else r.length>0?r[r.length-1]["else"]?r[r.length-1]["else"].push(e):r[r.length-1].param.push(e):t.push(e)}),r.length>0)throw"`for` or `if` statement not terminated.";return t}function render(e,t){return e.reduce(function(e,r){return"function"==typeof r?2===r.length?e+r(t,t):e+r(t):e+r},"")}String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")});var oplist=["=","for","endfor","if","else","endif"],exp={"=":function(_exp){return function(data){var e=_exp.substr(1).trim();return e=e.replace(/\$/g,"data."),eval(e)}},"for":function(e,t){var r=e.substr(3).trim().split("as"),n=r[0].trim().substr(1),p=r.length<2?"_i":r[1].trim().substr(1);return function(e,r){var s=n.split(".").reduce(function(e,t){return e[t]},e),u=n.substr(0,n.lastIndexOf(".")).split(".").reduce(function(e,t){return e[t]},e),i="";return s.forEach(function(e,n){var s={};null===e||"undefined"==typeof e||"symbol"==typeof e||"object"!=typeof e&&"function"!=typeof e?(s[p]={},s[p].toString=function(){return null===e?"null":"undefined"==typeof e?"undefined":e.toString()}):s[p]=e,s[p]._index=n,s[p]._global=r,s[p]._parent=u,i+=t.reduce(function(e,t){return"function"==typeof t?2==t.length?e+t(s,r):e+t(s):e+t},"")}),i}},"if":function(_exp,_param,_else){var e=_exp.substr(2).trim();return function(data){e=e.replace(/\$/g,"data.");var s=eval(e)?_param:_else;return s?s.reduce(function(e,t){return"function"==typeof t?2===t.length?e+t(data,data):e+t(data):e+t},""):""}}},parsed;return pre&&(parsed=parser(tokenizer(str))),function(e){return void 0===parsed&&(parsed=parser(tokenizer(str))),render(parsed,e)}}var root=this,old_fit;"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=fit),exports.fit=fit):(old_fit=root.fit,root.fit=fit,fit.noConflict=function(){return root.fit=old_fit,fit})}).call(this);